<p-dialog
  [header]="'Zakończ set ' + setNumber()"
  [visible]="visible()"
  (visibleChange)="onVisibleChange($event)"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  styleClass="finish-set-dialog"
  [style]="{ width: '90vw', maxWidth: '500px' }"
>
  <ng-template pTemplate="content">
    <div class="dialog-content">
      <!-- Potwierdzenie wyniku -->
      <div class="score-confirmation">
        <p class="confirmation-label">Wynik seta:</p>
        <p class="confirmation-score">
          {{ currentScore().player }} : {{ currentScore().opponent }}
        </p>
      </div>

      <!-- Uwagi trenera -->
      <div class="notes-section">
        <p-floatlabel>
          <textarea
            pTextarea
            id="coach-notes"
            [(ngModel)]="coachNotes"
            [rows]="5"
            [autoResize]="true"
            [disabled]="isLoading()"
            class="notes-textarea"
          ></textarea>
          <label for="coach-notes">Uwagi do seta (opcjonalnie)</label>
        </p-floatlabel>

        <!-- Licznik znaków i błąd walidacji -->
        <div class="notes-footer">
          <small
            class="char-counter"
            [class.error]="!isValid()"
          >
            {{ coachNotes.length }} / {{ MAX_NOTES_LENGTH }}
          </small>
          <small
            *ngIf="getValidationError()"
            class="validation-error"
          >
            {{ getValidationError() }}
          </small>
        </div>
      </div>
    </div>
  </ng-template>

  <ng-template pTemplate="footer">
    <div class="dialog-footer">
      <p-button
        label="Anuluj"
        [outlined]="true"
        (onClick)="onCancel()"
        [disabled]="isLoading()"
      />
      <p-button
        label="Zapisz"
        (onClick)="onConfirm()"
        [disabled]="!isValid() || isLoading()"
        [loading]="isLoading()"
        loadingIcon="pi pi-spinner pi-spin"
      />
    </div>
  </ng-template>
</p-dialog>

